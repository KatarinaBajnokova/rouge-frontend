import{n as l,r as a,j as s}from"./react-BNfDklOQ.js";import{l as m}from"./index-Cd1dwsJR.js";function p({refresh:r}){const c=l(),[n,i]=a.useState(0),o=async()=>{try{const t=await fetch("/api/basket");if(!t.ok)throw new Error(`Status ${t.status}`);const e=await t.json(),u=Array.isArray(e.items)?e.items.reduce((b,k)=>b+(k.quantity||0),0):0;i(u)}catch(t){console.error("❌ Failed to fetch basket count:",t)}};return a.useEffect(()=>{o()},[r]),a.useEffect(()=>{const t=e=>{e.key==="basketRefresh"&&o()};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[]),s.jsxs("button",{type:"button",className:"basket-button","aria-label":"Open basket",onClick:()=>c("/basket"),children:[s.jsx("img",{src:m,alt:"",className:"basket-button__icon"}),s.jsx("span",{className:"basket-button__label",children:"Basket"}),n>0&&s.jsx("span",{className:"basket-button__count",children:n})]})}export{p as B};
